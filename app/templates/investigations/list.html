{% extends 'base.html' %}
{% block title %}Vizsgálatok{% endblock %}
{% block content %}
<div class="card-body d-flex align-items-center py-3">
  <div>
    <h3 class="h4 mb-0">Vizsgálatok</h3>
  </div>
</div>

<form method="get" action="{{ url_for('investigations.list_investigations') }}" class="row g-3 mb-4">
  <div class="col-md-3">
    <label for="search" class="form-label">Keress bármire</label>
    <input type="text" class="form-control" id="search" name="q" value="{{ q }}" placeholder="Keresés...">
  </div>
  <div class="col-md-3 d-flex align-items-end">
    <button type="submit" class="btn btn-primary me-2">Szűrés</button>
    <a href="{{ url_for('investigations.list_investigations') }}" class="btn btn-outline-secondary">Törlés</a>
  </div>
</form>
<div class="card shadow-sm mb-4">
  <div class="table-responsive">
    <table class="table table-bordered align-middle mb-0">
      <thead class="table-light">
        <tr class="fw-bold text-secondary">
          <th>Vizsgálat szám</th>
          <th>Vizsgált neve</th>
          <th>Típus</th>
          <th>Intézmény</th>
          <th>Regisztrálva</th>
          <th>Határidő</th>
          <th>Szakértő 1</th>
          <th>Szakértő 2</th>
          <th>Leíró</th>
        </tr>
      </thead>
      <tbody>
        {% for inv in investigations %}
        <tr>
          <td><a href="{{ url_for('investigations.detail_investigation', id=inv.id) }}">{{ inv.case_number }}</a></td>
          <td>{{ inv.subject_name }}</td>
          <td>{{ inv.investigation_type }}</td>
          <td>{{ inv.institution_name }}</td>
          <td>{{ inv.registration_time_str }}</td>
          <td>{{ inv.deadline_str }}</td>
            <td>{{ inv.expert1_name }}</td>
            <td>{{ inv.expert2_name }}</td>
            <td>{{ inv.describer_name }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="9" class="text-center">Nincs megjeleníthető vizsgálat.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% if pagination.pages > 1 %}
<nav aria-label="Oldal navigáció">
  <ul class="pagination justify-content-center">
    <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for('investigations.list_investigations', q=q, page=pagination.prev_num) }}" aria-label="Előző">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    {% for p in range(1, pagination.pages + 1) %}
    <li class="page-item {% if p == pagination.page %}active{% endif %}">
      <a class="page-link" href="{{ url_for('investigations.list_investigations', q=q, page=p) }}">{{ p }}</a>
    </li>
    {% endfor %}
    <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for('investigations.list_investigations', q=q, page=pagination.next_num) }}" aria-label="Következő">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</nav>
{% endif %}
{% endblock %}