{% extends "base.html" %}
{% import 'includes/case_macros.html' as cm with context %}

{% block title %}Pénzügy Dashboard – CaseTracker{% endblock %}

{% block content %}
<div class="card-body d-flex align-items-center py-3">
  <div>
    <h3 class="h4 mb-0"><small>Kezdőlap:</small> Pénzügy</h3>
  </div>
</div>

<h4 class="mt-4">Ügyek</h4>
{{ cm.cases_table(cases, users_map, sort_by=sort_by, sort_order=sort_order, query_params=query_params, show_actions=False) }}

<h4 class="mt-4">Vizsgálatok</h4>
<div class="card shadow-sm mb-4">
  <div class="table-responsive">
    <table class="table table-bordered align-middle mb-0">
      <thead class="table-light">
        <tr class="fw-bold text-secondary">
          <th>Vizsgálat szám</th>
          <th>Vizsgált neve</th>
          <th>Típus</th>
          <th>Intézmény</th>
          <th>Regisztrálva</th>
          <th>Határidő</th>
          <th>Szakértő 1</th>
          <th>Szakértő 2</th>
          <th>Leíró</th>
        </tr>
      </thead>
      <tbody>
        {% for inv in investigations %}
        <tr>
          <td><a href="{{ url_for('investigations.detail_investigation', id=inv.id) }}">{{ inv.case_number }}</a></td>
          <td>{{ inv.subject_name }}</td>
          <td>{{ inv.investigation_type }}</td>
          <td>{{ inv.institution_name }}</td>
          <td>{{ inv.registration_time_str }}</td>
          <td>{{ inv.deadline_str }}</td>
          <td>{{ inv.expert1_name }}</td>
          <td>{{ inv.expert2_name }}</td>
          <td>{{ inv.describer_name }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="9" class="text-center">Nincs megjeleníthető vizsgálat.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}