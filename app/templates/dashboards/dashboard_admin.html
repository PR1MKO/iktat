{% extends "base.html" %}
{% import 'includes/case_macros.html' as cm %}

{% block title %}Admin Dashboard â€“ CaseTracker{% endblock %}

{% block content %}
<div class="card-body d-flex align-items-center py-3">
  <i class="bi bi-person-check fs-3 me-3 text-primary"></i>
  <div>
    <h3 class="h4 mb-0"><small>KezdÅ‘lap:</small> Admin</h4>
  </div>
</div>

<div class="d-flex gap-2 mb-3">
  <a class="btn btn-outline-primary flex-fill" href="{{ url_for('auth.create_case') }}">â• Ãšj Ã¼gy rÃ¶gzÃ­tÃ©se</a>
  <a class="btn btn-outline-secondary flex-fill" href="{{ url_for('auth.list_cases') }}">ğŸ“‚ Ã–sszes Ã¼gy megtekintÃ©se</a>
  <a class="btn btn-outline-info flex-fill" href="{{ url_for('auth.admin_users') }}">ğŸ‘¥ FelhasznÃ¡lÃ³k kezelÃ©se</a>
  <a class="btn btn-outline-warning flex-fill" href="{{ url_for('auth.manage_cases') }}">ğŸ›  Ãœgyek kezelÃ©se</a>
</div>

<hr>

<div class="row mb-4 g-3">
  <div class="col-md-6">
    {{ cm.dashboard_card(
      'ğŸ—“ KÃ¶zelgÅ‘ hatÃ¡ridÅ‘k (14 napon belÃ¼l)',
      upcoming_deadlines
    ) }}
  </div>
</div>

<div class="row mb-4 g-3">
	<div class="col-md-6">
	  {{ cm.dashboard_card(
		'ğŸ“Š Gyors statisztikÃ¡k',
		items=[
		  ('Ãšj Ã¼gyek ma', new_today),
		  ('Ãšj Ã¼gyek ezen a hÃ©ten', new_this_week),
		  ('Ãšj Ã¼gyek ebben a hÃ³napban', new_this_month),
		  ('Nyitott Ã¼gyek', total_open),
		  ('LezÃ¡rt Ã¼gyek', closed_cases)
		]
	  ) }}
	</div>
  <div class="col-md-6">
    {{ cm.dashboard_card(
      'ğŸŸ¡ Ãllapot szerinti bontÃ¡s',
      items=status_counts_list
    ) }}
  </div>
</div>

<div class="row mb-4 g-3">
  <div class="col-md-6">
    <div class="card h-100 shadow-sm mb-3">
      <div class="card-header fw-bold">
        ğŸ“ˆ LegaktÃ­vabb felhasznÃ¡lÃ³k
      </div>
      <div class="card-body p-0">
        <ul class="list-group list-group-flush">
          {% if most_active_users %}
            {% for user, count in most_active_users %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>{{ user }}</span>
                <span><strong>{{ count }} mÃ³dosÃ­tÃ¡s</strong></span>
              </li>
            {% endfor %}
          {% else %}
            <li class="list-group-item">Nincs ilyen felhasznÃ¡lÃ³.</li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card h-100 shadow-sm mb-3">
      <div class="card-header fw-bold">
        ğŸ•’ LegutÃ³bbi belÃ©pÃ©sek
      </div>
      <div class="card-body p-0">
        <ul class="list-group list-group-flush">
          {% if recent_logins %}
            {% for entry in recent_logins %}
              <li class="list-group-item">
                {{ entry.timestamp|localtime }} â€“ {{ entry.username }}
              </li>
            {% endfor %}
          {% else %}
            <li class="list-group-item">Nincs ilyen bejegyzÃ©s.</li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>
</div>

{% endblock %}
 