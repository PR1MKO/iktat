{% extends "base.html" %}
{% import 'includes/case_macros.html' as cm %}

{% block title %}Új vizsgálat{% endblock %}

{% block content %}
<div class="card-body d-flex align-items-center py-3">
  <i class="bi bi-person-check fs-3 me-3 text-primary"></i>
  <div>
    <h3 class="h4 mb-0"><small>Új vizsgálat</small></h3>
  </div>
</div>

<form method="post" class="row g-3 needs-validation" novalidate>
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <div class="col-md-6">
    <label for="investigation_number" class="form-label">Vizsgálati szám *</label>
    <input type="text" id="investigation_number" name="investigation_number" class="form-control" required>
    <div class="invalid-feedback">Kérjük, adja meg a vizsgálati számot.</div>
  </div>

  <div class="col-md-6">
    <label for="type" class="form-label">Típus</label>
    <input type="text" id="type" name="type" class="form-control">
  </div>

  <div class="col-md-6">
    <label for="institution" class="form-label">Intézmény</label>
    <input type="text" id="institution" name="institution" class="form-control">
  </div>

  <div class="col-md-6">
    <label for="ordering_authority" class="form-label">Megrendelő hatóság</label>
    <input type="text" id="ordering_authority" name="ordering_authority" class="form-control">
  </div>

  <div class="col-md-6">
    <label for="deceased_name" class="form-label">Vizsgált személy neve</label>
    <input type="text" id="deceased_name" name="deceased_name" class="form-control">
  </div>

  <div class="col-md-6">
    <label for="date_of_birth" class="form-label">Születési dátum</label>
    <input type="date" id="date_of_birth" name="date_of_birth" class="form-control">
  </div>

  <div class="col-12 d-flex gap-2">
    <button type="submit" class="btn btn-success">Létrehozás</button>
    <a href="{{ url_for('auth.dashboard') }}" class="btn btn-outline-secondary">Mégse</a>
  </div>
</form>

<script>
  (() => {
    'use strict';
    document.querySelectorAll('.needs-validation').forEach(form => {
      form.addEventListener('submit', e => {
        if (!form.checkValidity()) {
          e.preventDefault();
          form.classList.add('was-validated');
        }
      });
    });
  })();
</script>
{% endblock %}